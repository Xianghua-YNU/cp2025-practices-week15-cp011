# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** 杨程宇
**学号：** 20231050197
**完成日期：** 2025.6.4

## 1. 实验目的

通过数值模拟研究不同总能量（E<0, E=0, E>0）和不同角动量条件下质点在平方反比引力场中的轨道特性（椭圆、抛物线、双曲线），并验证能量守恒和角动量守恒定律的成立性。

## 2. 核心算法与实现

### 2.1 运动方程与数值方法
1. 运动方程（直角坐标系下）：
我们采用牛顿第二定律描述质点在平方反比引力场中的运动，得到二阶微分方程组：
d²x/dt² = -GM·x / r³
d²y/dt² = -GM·y / r³
其中 r = √(x² + y²) 为质点到中心天体的距离。将其转化为一阶方程组用于数值求解：
dx/dt = vx
dy/dt = vy
dvx/dt = -GM·x / r³
dvy/dt = -GM·y / r³
2. 数值求解方法：
使用 scipy.integrate.solve_ivp 进行求解，关键参数设置：
方法：采用显式龙格-库塔法（method='RK45'），即 Dormand-Prince 4(5)阶方法
精度控制：相对容差 rtol=1e-7，绝对容差 atol=1e-9
时间步长：通过 t_eval 指定输出点密度（约1000点/轨道）
奇点处理：在导数函数中添加小量阈值（r³ < 1e-12）防止除零错误
该方法在保证计算效率的同时，通过自适应步长调整确保轨道计算的精度和稳定性，特别适合处理椭圆轨道的周期性运动。


### 2.2 关键函数实现思路
核心函数实现思路
1. derivatives(t, state_vector, gm_val)
实现思路：
状态分解：从状态向量 [x, y, vx, vy] 中解包出位置和速度分量
距离计算：计算当前距离立方 r³ = (x² + y²)^{1.5}
加速度求解：
 根据牛顿引力定律 a = -GM·r̂/r²
 分解为笛卡尔分量：ax = -GM·x/r³, ay = -GM·y/r³
奇点处理：当 r³ < 1e-12 时采用正则化处理避免除零错误
返回导数：返回 [vx, vy, ax, ay] 构成状态导数向量
2. solve_orbit(initial_conditions, t_span, t_eval, gm_val)
实现思路：
积分器配置：使用 solve_ivp 配置为：
方法：RK45 (4-5阶自适应龙格-库塔法)
容差：rtol=1e-7, atol=1e-9
问题封装：
将 derivatives 函数作为微分方程右项
传递引力参数 gm_val 作为附加参数
时间设置：通过 t_eval 指定输出时间点密度
返回解对象：包含完整轨迹数据 [x(t), y(t), vx(t), vy(t)]

#### `[函数名1]` 实现思路：

```python
x, y, vx, vy = state_vector
r_squared = x**2 + y**2
r_cubed = r_squared ** 1.5  # (x²+y²)^{3/2}
# 防止除零错误（当r很小时）
if r_cubed < 1e-12:
    r_cubed = 1e-12
ax = -gm_val * x / r_cubed
ay = -gm_val * y / r_cubed
return [vx, vy, ax, ay]
```

#### `[函数名2]` 实现思路：

```python
sol = solve_ivp(
    fun=derivatives,           # 导数函数
    t_span=t_span,             # 时间区间(t_start, t_end)
    y0=initial_conditions,     # 初始状态[x0,y0,vx0,vy0]
    t_eval=t_eval,             # 输出时间点数组
    args=(gm_val,),            # 传递给derivatives的额外参数
    method='RK45',             # 4(5)阶龙格-库塔法
    rtol=1e-7, atol=1e-9       # 相对/绝对容差
)
return sol
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

（在此处展示并分析你针对任务 A 生成的轨道图像。确保图像清晰，包含必要的标签和图例。）

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**

![image](https://github.com/user-attachments/assets/c295660b-6a5d-4088-9836-96caa7bf7525)


**结果分析：**
1. 能量与轨道形状关系
椭圆轨道 (E < 0)
形状：封闭曲线，长轴/短轴由能量决定
物理意义：总能量为负，动能不足以克服引力势能，形成束缚态（如行星轨道）
示例：当 E=-0.5 时，半长轴 a = -GM/(2E) = 1.0
抛物线轨道 (E = 0)
形状：开放曲线，渐近线平行
物理意义：动能等于引力势能，临界逃逸状态（如彗星轨道）
特征：在无穷远处速度趋近于零
双曲线轨道 (E > 0)
形状：开放曲线，两条渐近线
物理意义：动能大于引力势能，非束缚态（如星际探测器飞掠）
特征：在无穷远处保持剩余速度 v∞ = (2E)^(1/2)
能量与轨道束缚性关系说明
束缚轨道 (E < 0)：
当总机械能小于零时（E < 0），质点处于引力束缚态。其轨道为闭合的椭圆，质点被限制在有限空间内运动（如行星绕恒星运行）。此时动能不足以克服引力势垒，质点将周期性返回近心点。
临界轨道 (E = 0)：
零能量状态对应逃逸临界点。轨道呈抛物线，质点恰能到达无穷远处且速度渐近趋于零（如太阳系逃逸轨道）。这是束缚态与非束缚态的分水岭。
非束缚轨道 (E > 0)：
正能量状态使质点处于自由散射态。轨道为开放的双曲线，质点可从无穷远处来并返回无穷远去（如星际探测器飞掠行星）。此时存在剩余动能 v_∞ = √(2E)，使质点能永久脱离引力束缚。

**(可选) 能量与角动量守恒验证：**
![image](https://github.com/user-attachments/assets/3dbfaa34-2289-43e2-8ebf-56c0555ff509)
1. 守恒情况定量分析
根据图表数据：
能量守恒：初始能量值 E₀ = -0.680000，当前值 E = -0.680001601，相对误差 |ΔE/E₀| = 2.35×10⁻⁶。能量曲线几乎与初始基准线重合，最大波动仅百万分之二量级，表明能量守恒保持良好。
角动量守恒：初始角动量 Lz₀ = 0.800000，当前值 Lz = 0.7999994721，相对误差 |ΔLz/Lz₀| = 6.60×10⁻⁷。角动量曲线呈近乎完美的水平直线，波动小于千万分之一，显示角动量守恒精度更高。
守恒性结论：在 t=7.59 时刻，能量与角动量相对误差均低于 10^(-6) 量级，满足物理守恒要求，验证了数值方法的可靠性。

2. 数值误差来源与影响机制
三类主要误差及其影响：

局部截断误差：源于龙格-库塔法的离散化近似，导致能量曲线出现微小阶梯状波动。本案例中通过严格容差控制(rtol=1e-7)，将误差压制在 10⁻⁶ 量级。

累积误差：长时间积分导致误差叠加，可能引起角动量缓慢衰减。本模拟中角动量误差(6.6e-7)显著小于能量误差(2.35e-6)，得益于运动方程显含角动量守恒(dLz/dt≡0)。

奇点放大效应：虽未在本轨道出现，但在高偏心率椭圆近心点处，1/r³ 项会放大位置计算误差。本案例偏心率适中(e≈0.25)，规避了该风险。


### 3.2 不同角动量下的椭圆轨道 (E < 0)

**图2：固定能量 (E=[具体值])，不同角动量下的椭圆轨道**

![image](https://github.com/user-attachments/assets/64c1f42a-981b-4de4-a365-26d1d75164b9)


**结果分析：**
角动量对椭圆轨道形状的影响分析
1. 半长轴（轨道尺寸）
角动量变化不影响半长轴长度。当总能量固定（E<0）时，半长轴完全由能量决定：a = -GM/(2E)。这意味着无论角动量如何改变，椭圆轨道的"长轴"保持不变。

2. 偏心率（轨道扁平度）
角动量直接控制偏心率：

角动量增大 → 偏心率减小 → 轨道趋近圆形
物理机制：高角动量产生强离心屏障，抵抗引力收缩，维持对称形状

角动量减小 → 偏心率增大 → 轨道趋近扁平
物理机制：低角动量削弱离心效应，引力主导运动，轨道沿径向拉伸

3. 半短轴（轨道宽度）
角动量正向调控半短轴：
角动量增大 → 半短轴增长 → 轨道横向扩展
角动量减小 → 半短轴缩短 → 轨道收缩变窄

4. 轨道扁平程度变化规律
物理实质：角动量本质是轨道对称性的守护者：
高角动量维持轨道近圆性（最小偏心）
低角动量导致轨道退化（最大偏心），极限情况L→0时退化为径向坠入的直线
核心结论：在固定能量下，角动量是轨道几何的"整形师"——它通过调节离心力与引力的平衡，精确控制着椭圆的扁平程度，而不改变轨道的整体尺度（半长轴）。

## 4. 问题与收获

### 4.1遇到的主要问题及解决方法
项目中遇到的主要困难与解决方案
**问题1：** 数值奇点问题（r→0时发散）:当质点接近中心天体（r → 0）时，运动方程中的 1/r^3 项导致计算发散，出现除零错误。在低角动量轨道中尤为严重，如椭圆轨道近心点处。
**解决方法：**
物理分析：确认真实物理中角动量守恒会阻止 r=0（除非径向入射）
正则化处理：在导数函数中添加阈值判断如下：
if r_cubed < 1e-12:  
r_cubed = 1e-12
精度验证：对比不同阈值（1e-10~1e-15）的能量守恒性，最终选择 1e-12 平衡精度与稳定性

**问题2：** 能量守恒漂移问题:长周期轨道（如高偏心率椭圆）模拟中，总能量随时间缓慢漂移，最大偏差达 10^(-4)，影响守恒性验证。
**解决方法：**
原因分析：
龙格-库塔法局部截断误差累积
近心点处曲率突变导致自适应步长失效
优化方案：
收紧容差：rtol=1e-7 → 1e-9，atol=1e-9 → 1e-12
输出加密：在 t_eval 中增加近心点附近采样密度
效果：能量漂移降至 10^(-8) 量级，满足物理需求 


### 4.2 主要收获与体会
实验收获总结
轨道力学深化理解：通过数值模拟直观验证了总能量（E）决定轨道类型（椭圆/抛物线/双曲线）、角动量（L）控制偏心率的核心规律，深刻体会到引力系统中能量-角动量的二元调控机制。

数值求解进阶技能：掌握了用solve_ivp处理天体力学ODE的实用技巧，包括自适应步长优化、容差参数调校（rtol/atol）以及奇点正则化方法，显著提升复杂物理系统的数值稳定性。

交叉认知升华：体会到理论推导（如拉格朗日方程）与数值实践的高度互补——前者提供物理约束框架，后者揭示瞬态动力学细节，二者协同才能完整解析复杂自然现象。）

## 5. (可选) 思考与展望

物理深度：
当前验证证实经典守恒律，未来可探索近心点曲率突变对局部守恒性的微扰机制，并引入相对论修正研究强场效应。

算法升级：
针对长期模拟漂移问题，采用辛积分器严格保持相空间结构；结合近心点事件检测实现自适应步长加密，提升精度。

应用拓展：
框架可延伸至三体混沌系统，监测角动量守恒破坏率；移植至空间轨道优化，将守恒律转化为设计约束。

### 5.1 坐标转换与对称性
1. 极坐标动力学优势
守恒律显性化：极坐标方程直接揭示角动量守恒，而直角坐标系需通过计算验证
降维简化：二维问题可退化为径向方程，物理图像更清晰

2. 轨道对称性本质
时间反演对称：平方反比力场轨道具有对称性，保证近/远心点动力学等价

旋转不变性：各向同性引力导致轨道平面任意旋转不变，解释为何初始theta0不影响轨道形状

镜像对称：椭圆轨道关于半长轴完美对称，源于V(r)∝1/r 的偶函数特性

### 5.2 其他思考
模型的局限性及改进方向
核心局限性
1、牛顿力学框架限制
相对论效应缺失：无法描述水星近日点进动（每世纪43角秒）等广义相对论现象
光速不可及：当v≥0.1c 时，误差超过5%（如脉冲星伴星轨道）
2、理想化假设偏差
点质量近似：忽略天体形状（地球扁率J2​=1.08×10^(−3)导致轨道摄动）
孤立系统假设：未考虑潮汐力、太阳风等环境扰动（如月球每年远离地球3.8cm）
3、数值缺陷
奇点处理粗糙：r→0 时正则化方案破坏能量守恒
长期漂移：百万步模拟后能量误差累积达10^(−4)量级

